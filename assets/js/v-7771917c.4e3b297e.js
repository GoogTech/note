"use strict";(self.webpackChunknote_goog_tech=self.webpackChunknote_goog_tech||[]).push([[102],{7748:(l,i,p)=>{p.r(i),p.d(i,{data:()=>u});const u={key:"v-7771917c",path:"/computer-network/chapter04.html",title:"网络层",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:3,title:"概念",slug:"概念",children:[]},{level:3,title:"功能",slug:"功能",children:[]},{level:3,title:"路由算法",slug:"路由算法",children:[]},{level:3,title:"IPv4",slug:"ipv4",children:[]},{level:3,title:"解决IP地址耗尽",slug:"解决ip地址耗尽",children:[]},{level:3,title:"协议",slug:"协议",children:[]},{level:3,title:"IPv6",slug:"ipv6",children:[]},{level:3,title:"路由协议",slug:"路由协议",children:[]},{level:3,title:"IP组播",slug:"ip组播",children:[]},{level:3,title:"移动IP",slug:"移动ip",children:[]},{level:3,title:"路由器",slug:"路由器",children:[]}],filePathRelative:"computer-network/chapter04.md",git:{updatedTime:1632897486e3,contributors:[{name:"googtech",email:"hi@goog.tech",commits:1}]}}},5332:(l,i,p)=>{p.r(i),p.d(i,{default:()=>e});const u=(0,p(6252).uE)('<h1 id="网络层" tabindex="-1"><a class="header-anchor" href="#网络层" aria-hidden="true">#</a> 网络层</h1><h3 id="概念" tabindex="-1"><a class="header-anchor" href="#概念" aria-hidden="true">#</a> 概念</h3><ul><li>向上只提供简单灵活的、无连接的、尽最大努力交付的数据报服务</li></ul><h3 id="功能" tabindex="-1"><a class="header-anchor" href="#功能" aria-hidden="true">#</a> 功能</h3><ul><li><p>异构网络互联</p><ul><li><p>物理层中继系统</p><ul><li>中继器、集线器（Hub）</li></ul></li><li><p>数据链路层中继系统</p><ul><li>网桥或交换机</li></ul></li><li><p>网络层中级系统</p><ul><li>路由器（网关）</li></ul></li><li><p>网络层以上的中级系统</p><ul><li>网关</li></ul></li></ul></li><li><p>路由转发</p><ul><li><p>路由选择</p><ul><li>构造、更新、动态维护路由表</li></ul></li><li><p>路由转发</p><ul><li>通过路由表得出的转发表，将 IP 数据报从合适的端口转发出去</li></ul></li></ul></li><li><p>阻塞控制</p><ul><li><p>通过吞吐量和网络负载可判断网络是否阻塞</p></li><li><p>阻塞控制是指必须确保通信子网能够传送待传达的数据</p></li><li><p>流量控制是指抑制发送端发送数据的速率，以便接收方来得及接收</p></li><li><p>方法</p><ul><li><p>开环控制</p><ul><li>静态防御方法，事先考虑周全，中途不能修改</li></ul></li><li><p>闭环控制</p><ul><li>动态防御方法，采用监视以及及时检测手段</li></ul></li></ul></li></ul></li></ul><h3 id="路由算法" tabindex="-1"><a class="header-anchor" href="#路由算法" aria-hidden="true">#</a> 路由算法</h3><ul><li><p>静态路由算法（非自适应）</p><ul><li>需手工配置的路由信息，不能及时适应网络的变化</li><li>简便、开销小，但路由更新慢、不适用大型网络</li></ul></li><li><p>动态路由算法（自适应）</p><ul><li><p>路由表项由路由器之间彼此交换信息，然后按一定算法优化而来</p></li><li><p>性能佳、有助于流量控制，但算法复杂</p></li><li><p>分类</p><ul><li><p>距离-向量路由算法</p><ul><li>路由器只掌握物理相连的邻居及链路费用</li><li>为它的邻居提供从自己到网络中所有其他结点的最低费用估计</li></ul></li><li><p>链路状态路由算法</p><ul><li>所有路由器掌握完整的网络拓扑和链路费用信息</li><li>仅告诉它们与它直接相连的链路的费用</li></ul></li></ul></li></ul></li><li><p>层次路由</p><ul><li><p>解决因网络规模过大，而导致路由表成比例增大的问题</p></li><li><p>内部网关协议（IGP）</p><ul><li>RIP、OSPF</li></ul></li><li><p>外部网关协议（EGP）</p><ul><li>BGP</li></ul></li></ul></li></ul><h3 id="ipv4" tabindex="-1"><a class="header-anchor" href="#ipv4" aria-hidden="true">#</a> IPv4</h3><ul><li><p>概念</p><ul><li>采用点分十进制表示法</li><li>由网络号和主机号两部分组成，即 IP地址 :: = {，}</li></ul></li><li><p>数据报分片</p><ul><li>当数据报的总长度超过最大传送单元（MTU）则需进行分片</li><li>DF表示是否允许分片（0表示可以被分片），MF表示后面是否还有分片（0表示最后一个片）</li></ul></li><li><p>特殊的IP地址</p><ul><li><p>主机号全为 0 或 1</p><ul><li>全为 0 表示网络本身，如 202.98.174.0</li><li>全为 1 则表示直接广播地址，如 202.98.174.255</li></ul></li><li><p>32位全为 0 或 1</p><ul><li>全为 0 表示本网络上的本主机，如 0.0.0.0</li><li>全为 1 则表示受限广播地址，如 255.255.255.255</li></ul></li><li><p>127.x.x.x</p><ul><li>环回自检（Lookback Test）地址，其域名为 localhost，如 127.0.0.1</li></ul></li></ul></li><li><p>私有IP地址网段</p><ul><li><p>私有IP必须通过网关利用NAT，将其转换为Internet中合法的全球IP地址后才能正常上网</p></li><li><p>A类</p><ul><li>1个网段，即 10.0.0.0 ~ 10.255.255.255</li></ul></li><li><p>B类</p><ul><li>16个B类网段，即 172.16.0.0 ~ 172.31.255.255</li></ul></li><li><p>C类</p><ul><li>256个C类网段，即 192.168.0.0 ~ 192.168.255.255</li></ul></li></ul></li><li><p>分类的IP地址示例图</p><ul><li></li></ul></li><li><p>常用的三种类别 IP 地址的使用范围示例图</p><ul><li></li></ul></li></ul><h3 id="解决ip地址耗尽" tabindex="-1"><a class="header-anchor" href="#解决ip地址耗尽" aria-hidden="true">#</a> 解决IP地址耗尽</h3><ul><li><p>NAT</p><ul><li>通过将专用网络地址转换为公用地址，从而实现对外隐藏，降低受到网络攻击的风险</li><li>NAT转换表中存放着 {本地IP地址 : 端口号} 到 {全球IP地址 : 端口号} 的映射</li></ul></li><li><p>子网划分</p><ul><li><p>解决两级IP地址空间的利用率有时很低的问题</p></li><li><p>将两级IP地址变成三级IP地址，即 IP地址 = {，，}</p></li><li><p>子网掩码</p><ul><li>IP地址和其对应的子网掩码逐位&quot;与&quot;，即可得出相应子网的网络地址</li><li>A、B、C类地址默认的子网掩码分别为255.0.0.0、255.255.0.0、255.255.255.0</li></ul></li></ul></li><li><p>CIDR</p><p>无分类域间路由选择</p><ul><li>作用是把小的网络汇聚成大的超网</li><li>无分类两级IP地址为 IP :: = {，}</li></ul></li></ul><h3 id="协议" tabindex="-1"><a class="header-anchor" href="#协议" aria-hidden="true">#</a> 协议</h3><ul><li><p>ARP</p><ul><li>即地址解析协议，用于完成IP地址到MAC地址的映射（过程自动）</li><li>ARP请求分组是广播发送的，而ARP响应分组时普通的单播</li></ul></li><li><p>DHCP</p><ul><li>即动态主机配置协议，即插即用，常用于给主机动态分配临时IP地址</li><li>属于应用层协议，基于UDP，通过客户/服务器方式工作</li></ul></li><li><p>ICMP</p><ul><li><p>即网络控制报文协议，用于提供IP数据报交付成功的机会</p></li><li><p>PING使用了ICMP的询问报文中的回送请求和回答报文</p></li><li><p>种类</p><ul><li>ICMP差错报告</li><li>ICMP询问报文</li></ul></li></ul></li><li><p>IGMP</p><ul><li>使路由器知道组播组成员的信息，即是否有主机参加或退出</li></ul></li></ul><h3 id="ipv6" tabindex="-1"><a class="header-anchor" href="#ipv6" aria-hidden="true">#</a> IPv6</h3><ul><li><p>表示</p><ul><li>采用冒号十六进制记法，相继为 0 的值域可以用双冒号::代替</li><li>每4位用一个十六进制数表示，并用冒号:分割每16位</li></ul></li><li><p>特点</p><ul><li>不允许分片</li><li>取消校验和字段</li><li>从IPv4的32位增大了128位</li><li>即插即用，无需DHCP协议</li><li>首部长度必须是8B的整数倍，而IPv4则为4B的整数倍</li></ul></li><li><p>类型</p><ul><li>单播、多播、任播地址</li></ul></li><li><p>IPv4过渡到IPv6</p><ul><li><p>双协议栈</p><ul><li>同一台设备上同时装有IPv4和IPv6协议栈</li></ul></li><li><p>隧道技术</p><ul><li>将整个IPv6数据报封装到IPv4数据报的数据部分</li></ul></li></ul></li></ul><h3 id="路由协议" tabindex="-1"><a class="header-anchor" href="#路由协议" aria-hidden="true">#</a> 路由协议</h3><ul><li><p>自治系统（AS）</p><ul><li><p>域内路由选择</p><ul><li>自治系统内部的路由选择</li></ul></li><li><p>域间路由选择</p><ul><li>自治系统之间的路由选择</li></ul></li></ul></li><li><p>内部网关协议（IGP）</p><ul><li><p>RIP</p><p>路由信息协议</p><ul><li>只向自治系统中的相邻路由器发布路由信息</li><li>距离为16时表示网络不可达，故仅适用于小型网络</li><li>每30秒广播一次RIP路由更新信息，动态维护路由表</li></ul></li><li><p>OSPF</p><p>最短路径优先协议</p><ul><li><p>通过洪泛法向自治系统中的所有路由器发送信息</p></li><li><p>无RIP中的“坏消息传播的慢”的问题，适用于大型网络</p></li><li><p>每隔一段时间刷新一次数据库中的链路状态，确保链路状态数据库与全网状态同步</p></li><li><p>工作原理</p><ul><li><ol><li>各路由器之间频繁交换链路状态信息，最终构建链路状态数据库（拓扑结构图）</li></ol></li><li><ol start="2"><li>然后借助Dijkstra最短路径算法计算自己到各目的网络的最优路径，依次构造路由表</li></ol></li><li><ol start="3"><li>当链路状态发生变化时，重新执行以上步骤</li></ol></li></ul></li></ul></li></ul></li><li><p>外部网关协议（EGP）</p><ul><li><p>BGP</p><p>边界网关协议</p><ul><li>用于不同自治系统的路由器之间交换路由信息</li><li>力求找一条能够到达目的网路且比较好的路由，而非最佳路由</li></ul></li></ul></li><li><p>RIP、OSPF、BGP三种协议的比较示例图</p><ul><li></li></ul></li></ul><h3 id="ip组播" tabindex="-1"><a class="header-anchor" href="#ip组播" aria-hidden="true">#</a> IP组播</h3><ul><li><p>应用于视频点播和视频会议等多媒体应用</p></li><li><p>应用于UDP，主机通过IGMP协议加入组播组</p></li><li><p>IP组播地址</p><ul><li>D类地址范围为 224.0.0.0 ~ 239.255.255.255</li><li>以太网组播地址块的范围为 01-00-5E-00-00-00 ~ 01-00-5E-7F-FF-FF</li></ul></li><li><p>组播路由选择协议</p><ul><li><p>目的是找出以源主机为根节点的组播转发树（可避免环路）</p></li><li><p>算法</p><ul><li>链路状态的路由选择</li><li>距离-向量的路由选择</li><li>协议无关的组播（PIM）</li></ul></li></ul></li></ul><h3 id="移动ip" tabindex="-1"><a class="header-anchor" href="#移动ip" aria-hidden="true">#</a> 移动IP</h3><ul><li><p>永久地址</p><ul><li>移动站点在归属网络中的原始地址</li></ul></li><li><p>转交地址</p><ul><li>移动站点在外部网络中使用的临时地址</li></ul></li><li><p>移动到异地网络或返回本地网络时，辅地址改变或撤销，而主地址仍然不变</p></li></ul><h3 id="路由器" tabindex="-1"><a class="header-anchor" href="#路由器" aria-hidden="true">#</a> 路由器</h3><ul><li><p>交付方式</p><ul><li><p>直接交付</p><ul><li>源主机和目标主机在同一个网络上，故无须通过路由器</li></ul></li><li><p>间接交付</p><ul><li>路由器按照转发表指出的路由将数据报转发给下一个路由器</li></ul></li></ul></li><li><p>主要功能</p><ul><li><p>分组转发</p><ul><li>转发表查询、转发及相关的队列管理和任务调度</li></ul></li><li><p>路由计算</p><ul><li>通过和其它路由器进行基于路由协议的交换，完成路由表的计算</li></ul></li></ul></li><li><p>体系结构</p><ul><li><p>路由选择</p><ul><li><ol><li>路由选择处理机</li></ol></li><li><ol start="2"><li>路由选择协议</li></ol></li><li><ol start="3"><li>路由表</li></ol></li></ul></li><li><p>分组转发</p><ul><li><ol><li>交换结构</li></ol></li><li><ol start="2"><li>输入/输出端口</li></ol></li></ul></li></ul></li><li><p>路由表</p><ul><li>由路由算法得出，主要用于路由选择</li><li>既能隔离冲突域又能隔离广播域</li><li>包含四个项目：目的网络IP地址、子网掩码、下一跳IP地址、接口</li></ul></li><li><p>转发表</p><ul><li>由路由表所生成</li><li>分组的实际转发是靠直接查找转发表</li></ul></li></ul>',23),e={render:function(l,i){return u}}}}]);